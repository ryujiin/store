define(["../core","../var/document","../core/readyException","../deferred"],function(e,t){function r(){t.removeEventListener("DOMContentLoaded",r),window.removeEventListener("load",r),e.ready()}var n=e.Deferred();e.fn.ready=function(t){return n.then(t).catch(function(t){e.readyException(t)}),this},e.extend({isReady:!1,readyWait:1,holdReady:function(t){t?e.readyWait++:e.ready(!0)},ready:function(r){if(r===!0?--e.readyWait:e.isReady)return;e.isReady=!0;if(r!==!0&&--e.readyWait>0)return;n.resolveWith(t,[e])}}),e.ready.then=n.then,t.readyState==="complete"||t.readyState!=="loading"&&!t.documentElement.doScroll?window.setTimeout(e.ready):(t.addEventListener("DOMContentLoaded",r),window.addEventListener("load",r))});