define(["../core","../var/support","../ajax"],function(e,t){e.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var n={0:200,1223:204},r=e.ajaxSettings.xhr();t.cors=!!r&&"withCredentials"in r,t.ajax=r=!!r,e.ajaxTransport(function(e){var i,s;if(t.cors||r&&!e.crossDomain)return{send:function(t,r){var o,u=e.xhr();u.open(e.type,e.url,e.async,e.username,e.password);if(e.xhrFields)for(o in e.xhrFields)u[o]=e.xhrFields[o];e.mimeType&&u.overrideMimeType&&u.overrideMimeType(e.mimeType),!e.crossDomain&&!t["X-Requested-With"]&&(t["X-Requested-With"]="XMLHttpRequest");for(o in t)u.setRequestHeader(o,t[o]);i=function(e){return function(){i&&(i=s=u.onload=u.onerror=u.onabort=u.onreadystatechange=null,e==="abort"?u.abort():e==="error"?typeof u.status!="number"?r(0,"error"):r(u.status,u.statusText):r(n[u.status]||u.status,u.statusText,(u.responseType||"text")!=="text"||typeof u.responseText!="string"?{binary:u.response}:{text:u.responseText},u.getAllResponseHeaders()))}},u.onload=i(),s=u.onerror=i("error"),u.onabort!==undefined?u.onabort=s:u.onreadystatechange=function(){u.readyState===4&&window.setTimeout(function(){i&&s()})},i=i("abort");try{u.send(e.hasContent&&e.data||null)}catch(a){if(i)throw a}},abort:function(){i&&i()}}})});