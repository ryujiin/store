function Argv(e,t){function o(e){n.showHelp(),e&&console.error(e),process.exit(1)}function l(e){var t=minimist(e,r);t.$0=n.$0,i._&&t._.length<i._&&o("Not enough non-option arguments: got "+t._.length+", need at least "+i._);var s=[];return Object.keys(i).forEach(function(e){t[e]||s.push(e)}),s.length&&o("Missing required arguments: "+s.join(", ")),u.forEach(function(e){try{e(t)===!1&&o("Argument check failed: "+e.toString())}catch(n){o(n)}}),t}function c(e){return Math.max.apply(null,e.map(function(e){return e.length}))}var n={};t||(t=process.cwd()),n.$0=process.argv.slice(0,2).map(function(e){var n=rebase(t,e);return e.match(/^\//)&&n.length<e.length?n:e}).join(" "),process.env._!=undefined&&process.argv[1]==process.env._&&(n.$0=process.env._.replace(path.dirname(process.execPath)+"/",""));var r={"boolean":[],string:[],alias:{},"default":[]};n.boolean=function(e){return r.boolean.push.apply(r.boolean,[].concat(e)),n},n.string=function(e){return r.string.push.apply(r.string,[].concat(e)),n},n.default=function(e,t){return typeof e=="object"?Object.keys(e).forEach(function(t){n.default(t,e[t])}):r.default[e]=t,n},n.alias=function(e,t){return typeof e=="object"?Object.keys(e).forEach(function(t){n.alias(t,e[t])}):r.alias[e]=(r.alias[e]||[]).concat(t),n};var i={};n.demand=function(e){return typeof e=="number"?(i._||(i._=0),i._+=e):Array.isArray(e)?e.forEach(function(e){n.demand(e)}):i[e]=!0,n};var s;n.usage=function(e,t){return!t&&typeof e=="object"&&(t=e,e=null),s=e,t&&n.options(t),n};var u=[];n.check=function(e){return u.push(e),n};var a={};n.describe=function(e,t){return typeof e=="object"?Object.keys(e).forEach(function(t){n.describe(t,e[t])}):a[e]=t,n},n.parse=function(e){return l(e)},n.option=n.options=function(e,t){if(typeof e=="object")Object.keys(e).forEach(function(t){n.options(t,e[t])});else{t.alias&&n.alias(e,t.alias),t.demand&&n.demand(e),typeof t.default!="undefined"&&n.default(e,t.default),(t.boolean||t.type==="boolean")&&n.boolean(e),(t.string||t.type==="string")&&n.string(e);var r=t.describe||t.description||t.desc;r&&n.describe(e,r)}return n};var f=null;return n.wrap=function(e){return f=e,n},n.showHelp=function(e){e||(e=console.error),e(n.help())},n.help=function(){var e=Object.keys(Object.keys(a).concat(Object.keys(i)).concat(Object.keys(r.default)).reduce(function(e,t){return t!=="_"&&(e[t]=!0),e},{})),t=e.length?["Options:"]:[];s&&t.unshift(s.replace(/\$0/g,n.$0),"");var o=e.reduce(function(e,t){return e[t]=[t].concat(r.alias[t]||[]).map(function(e){return(e.length>1?"--":"-")+e}).join(", "),e},{}),u=c(Object.keys(o).map(function(e){return o[e]||""})),l=c(Object.keys(a).map(function(e){return a[e]||""}));return e.forEach(function(e){var n=o[e],s=a[e]||"";f&&(s=wordwrap(u+4,f)(s).slice(u+4));var c=(new Array(Math.max(u-n.length+3,0))).join(" "),h=(new Array(Math.max(l-s.length+1,0))).join(" "),p=null;r.boolean[e]&&(p="[boolean]"),r.string[e]&&(p="[string]"),!f&&h.length>0&&(s+=h);var d="  "+n+c,v=[p,i[e]?"[required]":null,r.default[e]!==undefined?"[default: "+JSON.stringify(r.default[e])+"]":null].filter(Boolean).join("  "),m=[s,v].filter(Boolean).join("  ");if(f){var g=s.split("\n"),y=g.slice(-1)[0].length+(g.length===1?d.length:0);m=s+(y+v.length>f-2?"\n"+(new Array(f-v.length+1)).join(" ")+v:(new Array(f-v.length-y+1)).join(" ")+v)}t.push(d+m)}),t.push(""),t.join("\n")},Object.defineProperty(n,"argv",{get:function(){return l(e)},enumerable:!0}),n}function rebase(e,t){var n=path.normalize(t).split("/").slice(1),r=path.normalize(e).split("/").slice(1);for(var i=0;n[i]&&n[i]==r[i];i++);n.splice(0,i),r.splice(0,i);var s=path.normalize(r.map(function(){return".."}).concat(n).join("/")).replace(/\/$/,"").replace(/^$/,".");return s.match(/^[.\/]/)?s:"./"+s}var path=require("path"),minimist=require("minimist"),wordwrap=require("wordwrap"),inst=Argv(process.argv.slice(2));Object.keys(inst).forEach(function(e){Argv[e]=typeof inst[e]=="function"?inst[e].bind(inst):inst[e]});var exports=module.exports=Argv;exports.rebase=rebase;