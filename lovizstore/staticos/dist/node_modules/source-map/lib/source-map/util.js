/*
 * Copyright 2011 Mozilla Foundation and contributors
 * Licensed under the New BSD license. See LICENSE or:
 * http://opensource.org/licenses/BSD-3-Clause
 */

define(["require","exports","module"],function(e,t,n){function r(e,t,n){if(t in e)return e[t];if(arguments.length===3)return n;throw new Error('"'+t+'" is a required argument.')}function o(e){var t=e.match(i);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function u(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function a(e){var t=e,n=o(e);if(n){if(!n.path)return e;t=n.path}var r=t.charAt(0)==="/",i=t.split(/\/+/);for(var s,a=0,f=i.length-1;f>=0;f--)s=i[f],s==="."?i.splice(f,1):s===".."?a++:a>0&&(s===""?(i.splice(f+1,a),a=0):(i.splice(f,2),a--));return t=i.join("/"),t===""&&(t=r?"/":"."),n?(n.path=t,u(n)):t}function f(e,t){var n=o(t),r=o(e);r&&(e=r.path||"/");if(n&&!n.scheme)return r&&(n.scheme=r.scheme),u(n);if(n||t.match(s))return t;if(r&&!r.host&&!r.path)return r.host=t,u(r);var i=t.charAt(0)==="/"?t:a(e.replace(/\/+$/,"")+"/"+t);return r?(r.path=i,u(r)):i}function l(e){return"$"+e}function c(e){return e.substr(1)}function h(e,t){e=e.replace(/\/$/,"");var n=o(e);return t.charAt(0)=="/"&&n&&n.path=="/"?t.slice(1):t.indexOf(e+"/")===0?t.substr(e.length+1):t}function p(e,t){var n=e||"",r=t||"";return(n>r)-(n<r)}function d(e,t,n){var r;return r=p(e.source,t.source),r?r:(r=e.originalLine-t.originalLine,r?r:(r=e.originalColumn-t.originalColumn,r||n?r:(r=p(e.name,t.name),r?r:(r=e.generatedLine-t.generatedLine,r?r:e.generatedColumn-t.generatedColumn))))}function v(e,t,n){var r;return r=e.generatedLine-t.generatedLine,r?r:(r=e.generatedColumn-t.generatedColumn,r||n?r:(r=p(e.source,t.source),r?r:(r=e.originalLine-t.originalLine,r?r:(r=e.originalColumn-t.originalColumn,r?r:p(e.name,t.name)))))}t.getArg=r;var i=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.]*)(?::(\d+))?(\S*)$/,s=/^data:.+\,.+$/;t.urlParse=o,t.urlGenerate=u,t.normalize=a,t.join=f,t.toSetString=l,t.fromSetString=c,t.relative=h,t.compareByOriginalPositions=d,t.compareByGeneratedPositions=v});