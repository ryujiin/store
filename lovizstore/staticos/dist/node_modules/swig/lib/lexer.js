function reader(e){var t;return utils.some(rules,function(n){return utils.some(n.regex,function(r){var i=e.match(r),s;if(!i)return;return s=i[n.idx||0].replace(/\s*$/,""),s=n.hasOwnProperty("replace")&&n.replace.hasOwnProperty(s)?n.replace[s]:s,t={match:s,type:n.type,length:i[0].length},!0})}),t||(t={match:e,type:TYPES.UNKNOWN,length:e.length}),t}var utils=require("./utils"),TYPES={WHITESPACE:0,STRING:1,FILTER:2,FILTEREMPTY:3,FUNCTION:4,FUNCTIONEMPTY:5,PARENOPEN:6,PARENCLOSE:7,COMMA:8,VAR:9,NUMBER:10,OPERATOR:11,BRACKETOPEN:12,BRACKETCLOSE:13,DOTKEY:14,ARRAYOPEN:15,CURLYOPEN:17,CURLYCLOSE:18,COLON:19,COMPARATOR:20,LOGIC:21,NOT:22,BOOL:23,ASSIGNMENT:24,METHODOPEN:25,UNKNOWN:100},rules=[{type:TYPES.WHITESPACE,regex:[/^\s+/]},{type:TYPES.STRING,regex:[/^""/,/^".*?[^\\]"/,/^''/,/^'.*?[^\\]'/]},{type:TYPES.FILTER,regex:[/^\|\s*(\w+)\(/],idx:1},{type:TYPES.FILTEREMPTY,regex:[/^\|\s*(\w+)/],idx:1},{type:TYPES.FUNCTIONEMPTY,regex:[/^\s*(\w+)\(\)/],idx:1},{type:TYPES.FUNCTION,regex:[/^\s*(\w+)\(/],idx:1},{type:TYPES.PARENOPEN,regex:[/^\(/]},{type:TYPES.PARENCLOSE,regex:[/^\)/]},{type:TYPES.COMMA,regex:[/^,/]},{type:TYPES.LOGIC,regex:[/^(&&|\|\|)\s*/,/^(and|or)\s+/],idx:1,replace:{and:"&&",or:"||"}},{type:TYPES.COMPARATOR,regex:[/^(===|==|\!==|\!=|<=|<|>=|>|in\s|gte\s|gt\s|lte\s|lt\s)\s*/],idx:1,replace:{gte:">=",gt:">",lte:"<=",lt:"<"}},{type:TYPES.ASSIGNMENT,regex:[/^(=|\+=|-=|\*=|\/=)/]},{type:TYPES.NOT,regex:[/^\!\s*/,/^not\s+/],replace:{not:"!"}},{type:TYPES.BOOL,regex:[/^(true|false)\s+/,/^(true|false)$/],idx:1},{type:TYPES.VAR,regex:[/^[a-zA-Z_$]\w*((\.\$?\w*)+)?/,/^[a-zA-Z_$]\w*/]},{type:TYPES.BRACKETOPEN,regex:[/^\[/]},{type:TYPES.BRACKETCLOSE,regex:[/^\]/]},{type:TYPES.CURLYOPEN,regex:[/^\{/]},{type:TYPES.COLON,regex:[/^\:/]},{type:TYPES.CURLYCLOSE,regex:[/^\}/]},{type:TYPES.DOTKEY,regex:[/^\.(\w+)/],idx:1},{type:TYPES.NUMBER,regex:[/^[+\-]?\d+(\.\d+)?/]},{type:TYPES.OPERATOR,regex:[/^(\+|\-|\/|\*|%)/]}];exports.types=TYPES,exports.read=function(e){var t=0,n=[],r,i;while(t<e.length)r=e.substring(t),i=reader(r),t+=i.length,n.push(i);return n};